---
title: Linux-计划任务
date: 2020-06-20 19:33:15
categories:
- [coding, linux]
tags: 
- linux
---
# 一次性计划任务 `at`

创建计划任务

```bash
at 18:31 # 在18:31分执行任务
at> echo hello > /tmp/hello.txt # 将输出重定向到文件中
# ctrl+d 提交任务
```

查看还没被执行的一次性任务

```bash
atq

```

# 周期性计划任务

## cron

-   配置方式
    
    -   `crontab -e`
-   查看现有的计划任务
    
    -   `crontab -l`
-   配置方式：
    
    -   分钟 小时 日期 月份 星期 执行的命令
    
    表达式：
    
    ```bash
    * * * * 1,5 # 周一和周五
    * * * * 1-5 # 周一至周五
    0 3 15 * * # 每月15号的3点整，分钟不能是*，不然就是3的每分钟都会执行
    
    ```
    

查看日志：

```bash
tail -f /var/log/cron #查看cron的日志
```

# 计划任务加锁

如果计算机不能按照预期时间运行

-   anacontab 延迟计划任务
-   flock 锁文件

## anacontab

```bash
# /etc/anacrontab #配置文件所在位置
```

## flock

```bash
flock -xn "/tmp/f.lock" -c "/root/a.sh" # x 排他锁 n 指定锁文件位置 c 执行命令位置
```