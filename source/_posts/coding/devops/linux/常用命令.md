---
title: Linux-常用命令
date: 2020-06-20 19:33:15
tags: 
- devops/linux
---

# 常用命令

查看文件：

```bash
ls -lh # 查看文件列表，并将文件大小进行转换
$ ls -lh
-rw-r--r--@  1 user  110534874   ***3.6M*** Dec 10 09:17 adaptive_index_granularity.pdf
```

统计命令运行时间

`time command`

## 查看文件内容：

```bash
cat file_name # 查看完整内容

head [-n] file_name # 查看文件开头内容，默认显示10行, 可以通过添加 -n来显示前n行

tail [-n] [-f] file_name # 查看文件结尾内容，默认显示10行，可以通过添加 -n来显示后n行。添加-f可以实时显示文件变动

wc -l file_name # 查看文件有多少行

more file_name # 分行显示，按空格可以继续显示。
```

## 打包与压缩

```bash
打包：
tar cf save_file source_file # 只打包

tar czf save_file source_file # 打包并压缩, 以gzip格式压缩
tar cjf save_file source_file # 打包并压缩，以bzip2格式压缩, 速度慢，压缩后容量更小

解压：

tar xf source_file -C target_path #将打包文件解包
tar zxf source_file -C target_path #将source_file以gzip格式解压
tar jxf source_file -C target_path #将source_file以bzip2格式解压
```

## Vi&Vim

进入编辑模式：

```bash
i # 以当前光标位置进入插入模式  
I # 以当前光标行的开始位置进入插入模式
a # 以当前光标位置的后一位进入插入模式
A # 以当前光标行的最后位置进入插入模式
o # 以当前光标行的下一行进入插入模式，会新建一行。 
O # 以当前光标行的上一行进入插入模式，会新建一行。
```

移动光标：

```bash
H: 光标左移
J: 光标下移
K: 光标上移
L: 光标右移
```

复制，剪切：

```bash
复制： yy,y$
光标在所需复制的行，按y键两次即可复制当前行的内容，在所需粘贴的地方按p，即可粘贴到光标所在的下一行。可以多次粘贴。
如需复制多行，则在复制时先按一次数字，即可复制该数字的行数。

如果需要复制当前光标到改行末尾的内容，则在光标处按`y,$`两个按键即可。粘贴时会粘贴到光标所在位置的后一个位置

剪切： dd,d$

撤销：u，可以多次撤销
取消撤销：ctrl+r
```

删除，替换内容：

```bash
x: 删除当前光标位置的字符
r: 替换当前光标位置的字符，先按r，然后输入新字符。
```

显示行数：

```bash
:set nu
```

跳转到指定行：

```bash
输入行数，按 shift + g
直接输入 shift+g, 即大写G即可跳转至最后一行
```

移动光标到该行的开始结尾：

```bash
shift + 6 (^) 跳转至该行开始位置
shift + 4 ($) 跳转至该行结束位置
```

保存：

```bash
:w /target_file_path_and_name #保存文件到指定目录
:wq 保存并退出
```

执行命令：

```bash
:!command  # 可以执行其他命令
```

查找替换：

```bash
/target_char #查找指定的字符，n查找下一个，shift+n查找上一个
:s/old/new # 替换旧字符到新字符，默认只查找并替换光标所在行
:%s/old/new # 全文查找替换旧字符，只替换第一个
:%s/old/new/g # 全部替换
:3,5s/old/new/g # 在3—5行内查找替换，带g则为全部替换
```

更新全局配置：

```bash
vim /etc/vimrc # 在最后一行添加所需的内容即可。
```

可视模式：

```bash
v #字符可视模式
V #行可视模式
ctrl+v #块可视模式

批量选择要操作的块，可以批量删除，修改，插入等操作。插入时只显示在一行中，按两次esc键即可
```

# 网络管理

-   ping

检测到目标主机之间网络是否畅通

-   traceroute

`traceroute -w 1` 最多等待一秒钟

检测网络质量，追踪路由，追踪每一跳

-   mtr
-   nslookup

`nslookup 域名`

通过域名查找IP

-   telnet

```jsx
yum install telnet -y
telnet www.baidu.com 80
```

检查端口连接状态

-   tcpdump

```bash
tcpdump -i any -n port 80 [and host 10.0.0.1] -w /tmp/filename
```

`-i any` 抓取所有网卡里面的数据包

`-n` 使用IP的形式显示，不显示域名

`port 80` 只抓取访问80端口的数据包

`host 10.0.0.1` 所有到指定主机的TCP通信都会被抓取

`-w` 保存到指定文件

-   netstat

常用的四个参数：

`n` 只显示IP

`t` 只显示TCP连接

`p` 显示进程

`l` TCP状态为Listen的